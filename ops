{"author":{"id":"9651e074800ffce4ff55d25c7d596811b440dd9a899244d020ad13de60790405"},"ops":[{"type":1,"timestamp":1494920193,"nonce":"+n72mh/Hu0nmCRK/7Xn7c5M28mk=","metadata":{"github-id":"MDU6SXNzdWUyMjg5NDA1Nzk=","github-url":"https://github.com/svpcom/wfb-ng/issues/4","origin":"github"},"title":"some times, fec recovery wrong packet","message":"hi, some times, after do fec, \nthe recoveryed packet is wrong, and the log  : fprintf(stderr, \"corrupted packet %u\\n\", seq);\nis dumpt.\n\nvoid LocalAggregator::send_packet(int ring_idx, int fragment_idx)\n{\n    wpacket_hdr_t* packet_hdr = (wpacket_hdr_t*)(rx_ring[ring_idx].fragments[fragment_idx]);\n    uint8_t *payload = (rx_ring[ring_idx].fragments[fragment_idx]) + sizeof(wpacket_hdr_t);\n\n    if (packet_hdr-\u003eseq \u003e seq + 1)\n    {\n        fprintf(stderr, \"%u packets lost\\n\", packet_hdr-\u003eseq - seq - 1);\n    }\n\n    seq = packet_hdr-\u003eseq;\n\n    if(packet_hdr-\u003epacket_size \u003e MAX_PAYLOAD_SIZE)\n    {\n        fprintf(stderr, \"corrupted packet %u\\n\", seq);\n    }else{\n        send(sockfd, payload, packet_hdr-\u003epacket_size, 0);\n    }\n}","files":null}]}