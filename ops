{"author":{"id":"b42c6d1ee808b4b034f1e154594be9e4cb0db88ff924297832bb0738d3ead018"},"ops":[{"type":6,"timestamp":1743457670,"nonce":"0SSV+8g3vibjCXlp45OpZCIH1tA=","metadata":{"github-id":"UCE_lAHOBLCY8M6whl8uznZD0KU"},"target":"9c94ecf7e89dfe0475896c7a21d8607f65a7bc425920504c121b1cd890924279","message":"Missed packets per channel are the most important metrics for signal quality.\nMuch more important then RSSI or SNR.\nThis is the first sign that the link quality  is going bad for a channel.\nCurrently wfb_rx exposes these metrics\n```\n{\n    \"type\": \"rx\",\n    \"timestamp\": 1743453059.1416976,    \n    \"packets\": {\n        \"all\": [990, 91088],\n        \"dec_err\": [0, 936],\n        \"dec_ok\": [990, 90152],\n        \"fec_rec\": [0, 0],\n        \"lost\": [0, 0],\n        \"bad\": [0, 0],\n        \"out\": [398, 36032],\n        \"out_bytes\": [469674, 42121751]\n    },\n    \"session\": {},\n    \"rx_ant_stats\": [{\n            \"ant\": 256,                     \n            \"pkt_recv\": 495,\n           ...\n          \n        }, {\n            \"ant\": 0,          \n            \"pkt_recv\": 495,\n\t\t\t...         \n        }\n    ]\n}\n```\n\nImagine the following scenario.\nThe Tx sends 500 packets.\nChannel 1 receives 495, misses 5 (spread in the first half of the period)\nChannel 2 receives 495, misses 5 (spread in the last part of the period)\nSince all the missed packets of Channel 1 are received by Channel 2, the aggregator will compensate them and no FEC will be needed, so `fec_rec` will be 0.\nAnd there is no way to tell from the exported statistics that 5 packets were missed by every channel.\n\nI have implemented this metric in an ugly way, so I don't dare to do a PR with such an implementation:\nhttps://github.com/tipoman9/wfb-ng/blob/731c227e5abd096c083723e3ee60420ce9a674db/src/rx.cpp#L498\nBut I can't imagine flying without it, since digital signal tend to break suddenly, unlike analogue one.\nIt would be very nice if you implement this feature the proper way in wfb_rx and export it via the TCP statistics.\nHere it is how it looks like in flight\n\n![Image](https://github.com/user-attachments/assets/833dfb2c-bbb0-4fa1-852e-b49f90df68d9)\n\n\nEDIT.\nMaybe an easier option would be to add the total amount of aggregated packets before FEC. \nIf antenna packets are substracted from this metrics, that should give the missed packets per channel.","files":null}]}